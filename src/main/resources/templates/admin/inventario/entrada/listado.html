<!DOCTYPE html>
<html lang="es" xmlns:th="http://www.thymeleaf.org">
    <head>
        <meta charset="UTF-8">
        <title>Inventario · Entradas</title>
    </head>
    <body>
        <section th:fragment="content">
            <h2 class="mb-4">Gestión de Inventario / Entradas de Inventario</h2>

            <form class="row g-2 mb-3" method="get" th:action="@{/admin/inventario/entradas}">
                <div class="col-sm-6 col-lg-4">
                    <input class="form-control" type="text" name="q"
                           placeholder="Buscar entrada de inventario..."
                           th:value="${filtro}">
                </div>
                <div class="col-auto"><button class="btn btn-outline-primary" type="submit">Filtrar</button></div>
                <div class="col-auto"><a class="btn btn-outline-secondary" th:href="@{/admin/inventario/entradas}">Limpiar</a></div>
                <div class="col-auto ms-auto">
                    <a class="btn btn-primary" th:href="@{/admin/inventario/entradas/nuevo}">Añadir Entrada</a>
                </div>
            </form>

            <div class="table-responsive">
                <table class="table align-middle">
                    <thead>
                        <tr>
                            <th>N° de Entrada</th>
                            <th>Fecha de Entrada</th>
                            <th>Proveedor</th>
                            <th>Producto</th>
                            <th class="text-end">Cantidad Ingresada</th>
                            <th class="text-end">Precio de Costo</th>
                            <th class="text-end">Precio de Venta</th>
                            <th class="text-end">Punto de Reorden</th>
                            <th class="text-end">Acciones</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr th:each="e : ${entradas}">
                            <td th:text="${e.idEntrada}">1</td>
                            <!-- Si fecha es LocalDateTime usa #temporals, si fuera java.util.Date sería #dates -->
                            <td th:text="${e.fecha != null ? #temporals.format(e.fecha, 'yyyy-MM-dd HH:mm') : '-'}">2025-06-01</td>
                            <td th:text="${e.proveedor != null ? e.proveedor.nombre : '-'}">FarmaVida</td>
                            <td th:text="${e.producto != null ? e.producto.nombre : '-'}">Paracetamol</td>
                            <td class="text-end" th:text="${e.cantidad}">0</td>
                            <td class="text-end" th:text="${e.costoUnitario != null ? #numbers.formatDecimal(e.costoUnitario,1,2) : '-'}">0</td>
                            <td class="text-end" th:text="${e.precioVentaSug != null ? #numbers.formatDecimal(e.precioVentaSug,1,2) : '-'}">0</td>
                            <td class="text-end" th:text="${e.puntoReordenRef != null ? e.puntoReordenRef : '-'}">0</td>
                            <td class="text-end">
                                <a class="btn btn-sm btn-outline-primary"
                                   th:href="@{/admin/inventario/entradas/modificar/{id}(id=${e.idEntrada})}">
                                    Editar
                                </a>
                                <form class="d-inline"
                                      th:action="@{/admin/inventario/entradas/eliminar/{id}(id=${e.idEntrada})}"
                                      method="post"
                                      onsubmit="return confirm('¿Eliminar entrada? Esto ajustará el stock.');">
                                    <button class="btn btn-sm btn-outline-danger">Eliminar</button>
                                </form>
                            </td>
                        </tr>

                        <tr th:if="${#lists.isEmpty(entradas)}">
                            <td colspan="9" class="text-center text-muted py-4">Sin resultados</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </section>
    </body>
</html>
